<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Joke</title>
    <style>
      body {
        font-family: Arial;
        background: #f0f4f8;
        padding: 40px;
      }
      .container {
        padding: 20px;
        align-items: left;
        background: white;
        max-width: 500px;
        margin: auto;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }
      button {
        color: white;
        background-color: #4f46e5;
        border: none;
        border-radius: 6px;
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h2>Joke Generator</h2>
      <p id="joke">Press the button to load a joke</p>
      <button id="btn">Get a Joke</button>
      <p id="error" style="display: none"></p>
    </div>

    <script>
      const jokeEl = document.getElementById("joke");
      const btn = document.getElementById("btn");
      const errEl = document.getElementById("error");

      // Simple fallback Jokes
      const fallback = [
        "Why do programmers hate nature? Too many bugs!",
        "Why did the function break up with the variable? It needed space.",
        "Why was the computer cold? It forgot to close its Windows.",
      ];

      const API = "https://official-joke-api.appspot.com/random_joke";

      async function getJoke() {
        try {
          const response = await fetch(API);

          if (!response.ok) {
            throw new Error("Network response was not ok");
          }

          const data = await response.json();
          return `Setup: ${data.setup} - Punchline:${data.punchline}`;
        } catch (error) {
          const random = fallback[Math.floor(Math.random() * fallback.length)];

          errEl.style.display = "block";

          errEl.textContent = "Using fallback joke due to an error.";

          return random;
        }
      }

      async function updateJoke() {
        btn.disabled = true;
        btn.textContent = "Loading...";
        errEl.style.display = "none";

        const joke = await getJoke();
        jokeEl.textContent = joke;

        btn.disabled = false;
        btn.textContent = "Get Joke";
      }

      btn.addEventListener("click", updateJoke);
    </script>
  </body>
</html>
